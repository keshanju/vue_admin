(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-271ce2fb"],{d670:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("DxDataGrid",{ref:t.dxDataGridKey1})],1)},n=[],i=(a("b06f"),a("4453"),a("ee95")),c=a("eb12"),o=a("ba94"),s=a("5ee8"),u=a("4e86"),d=a("5bc3"),p=a("3a61"),l=a("b2e6"),h=a("a60a"),f=a.n(h),v=a("74a9"),g=a("1639"),w=a("effb"),m=a("4c5d"),b=a("84ec"),x=function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(s["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.dxDataGridKey1="dxDataGridKey1",t.cardAPI=new w["a"],t.cardData1={},t}return Object(d["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){this.$parent.content_title="充值卡管理",this.cardData1.id=0,this.cardData1.account_token=this.token,this.initComponent(),this.getCardsList()}},{key:"initComponent",value:function(){this.dxDataGrid1=this.getDxInstanceByKey(this.dxDataGridKey1);var t=[{dataField:"id",caption:"编号",width:80},{allowFiltering:!0,allowSorting:!0,dataField:"title",caption:"卡名称",width:120},{allowFiltering:!0,allowSorting:!0,dataField:"card_prefix",caption:"卡前缀",width:80},{dataField:"is_valid",caption:"是否有效",cellTemplate:function(t,e){var a=0==e.value?"red":"green";f()("<span style='color:"+a+"'>").append(m["a"].getDicText(m["a"].getDictonary().data.flag,e.value)).appendTo(t)},width:100},{dataField:"price_type",caption:"价格类型",cellTemplate:function(t,e){f()("<span>").append(m["a"].getDicText(m["a"].getDictonary().data.price_type,e.value)).appendTo(t)},width:100},{allowFiltering:!0,allowSorting:!0,dataField:"price",caption:"单价(分)",width:80},{allowFiltering:!0,allowSorting:!0,dataField:"minutes",caption:"分钟数",width:80},{dataField:"desc",caption:"卡描述",width:150},{dataField:"create_staff_name",caption:"创建人",width:80},{dataField:"create_time",caption:"创建时间",width:160},{fixed:!0,fixedPosition:"right",dataField:"id",alignment:"center",caption:b["a"].Operate,width:300,cellTemplate:this.cellEdit}],e=this.getDataGridOption({onToolbarPreparing:this.onToolbarPreparingHandler,columns:t});this.dxDataGrid1.option(e)}},{key:"cellEdit",value:function(t,e){var a=this,r="失效";0==e.key.is_valid&&(r="有效");var n=f()("<a href='#' data="+e.value+"> "+r+" </a>");n.bind("click",function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r=f()(e.target).attr("data"),a.cardData1.is_valid=0==a.cardData1.is_valid?1:0,a.cardData1.id=Number(r),t.next=5,a.invalidCard();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());var c=this.getCreateLink("开卡",function(t){a.redirect("/card/"+e.value+"/open/edit")}),o=this.getCreateLink("开卡列表",function(t){a.redirect("/card/"+e.value+"/open/list")}),s=this.getCreateLink("已废弃卡",function(t){a.redirect("/card/"+e.value+"/abandon/list")}),u=this.getCreateLink("已使用卡",function(t){a.redirect("/card/"+e.value+"/used/list")});f()("<div>").append(c).append(" | ").append(n).append(" | ").append(o).append(" | ").append(s).append(" | ").append(u).appendTo(t)}},{key:"invalidCard",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.cardData1.account_token=this.token,e=this.joinFormParams(this.cardData1),t.next=4,this.cardAPI.cardsUpdate(this.cardData1.id,e);case 4:t.sent,this.dxDataGrid1.refresh();case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getCardsList",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this.getDataGridPager(function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e,r,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.cardAPI.cardsListPager(e,r,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e,a,r){return t.apply(this,arguments)}}()),this.dxDataGrid1.option({remoteOperations:!0,dataSource:e});case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"onToolbarPreparingHandler",value:function(t){var e=this,a=(t.component,t.toolbarOptions.items);a.push({location:"before",widget:"dxButton",options:{text:b["a"].Add,icon:"add",onClick:this.onAddHandler}}),a.push({location:"before",widget:"dxButton",options:{icon:"refresh",text:"刷新",onClick:this.onRefreshHandler}}),this.createSearchToolbars(a,this.dxDataGrid1.option("columns"),function(){e.getCardsList()})}},{key:"onAddHandler",value:function(t){this.redirect("/card/edit")}},{key:"onRefreshHandler",value:function(t){this.dxDataGrid1.refresh()}}]),e}(g["a"]);x=p["a"]([Object(l["a"])({components:{DxDataGrid:v["DxDataGrid"]}})],x);var k=x,y=k,D=y,O=a("17cc"),R=Object(O["a"])(D,r,n,!1,null,null,null);e["default"]=R.exports},effb:function(t,e,a){"use strict";a.d(e,"a",function(){return d});a("4453");var r=a("ee95"),n=a("eb12"),i=a("ba94"),c=a("5ee8"),o=a("4e86"),s=a("5bc3"),u=a("f322"),d=function(t){function e(){return Object(n["a"])(this,e),Object(c["a"])(this,Object(o["a"])(e).apply(this,arguments))}return Object(s["a"])(e,t),Object(i["a"])(e,[{key:"cardsListPager",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a,r,n,i,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:"",a=c.length>1&&void 0!==c[1]?c[1]:15,r=c.length>2&&void 0!==c[2]?c[2]:1,n="/staff/card?account_token="+this.token+"&size="+a+"&page="+r+e,t.next=6,this.httpGet(n);case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"cardsAdd",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="/staff/card",t.next=3,this.httpPost(a,e);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"cardsUpdate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,a){var r,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r="/staff/card/"+e,t.next=3,this.httpPut(r,a);case 3:return n=t.sent,t.abrupt("return",n);case 5:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"getCardsModel",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a="/staff/card/"+e+"?account_token="+this.token,t.next=3,this.httpGet(a);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"cardsGenerate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,a){var r,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r="/staff/card/"+e+"/generate",t.next=3,this.httpPost(r,a);case 3:return n=t.sent,t.abrupt("return",n);case 5:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"getSimpleListResult",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="/staff/card/list?account_token="+this.token,t.next=3,this.httpGet(e);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getCardsExportData",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,a){var r,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r="/staff/cards/export",n={account_token:this.token,id:e,super_password:a},t.next=4,this.httpPostJsonDownFile(r,n,"export_cards.xlsx");case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}()}]),e}(u["a"])}}]);