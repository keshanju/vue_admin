(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21b26c"],{bf0b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("DxDataGrid",{ref:e.dxDataGridKey1}),a("AreaLine",{ref:"AreaLine"})],1)},n=[],r=(a("b06f"),a("77fe")),o=a.n(r),d=(a("48fb"),a("ea65"),a("4453"),a("ee95")),c=a("eb12"),l=a("ba94"),s=a("5ee8"),u=a("4e86"),p=a("5bc3"),h=a("3a61"),g=a("b2e6"),f=a("a60a"),m=a.n(f),v=a("74a9"),w=a("1639"),x=a("59f2"),b=a("84ec"),y=a("978f"),k=a("4c5d"),_=a("4b0b"),D=a("9b13"),F=a("87b4"),R=a("87fa"),A=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(s["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.dxDataGridKey1="dxDataGridKey1",e.gameAPI=new x["a"],e.gameAreaRegionApi=new y["a"],e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"mounted",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$parent.content_title="区服管理",this.initComponent(),e.next=4,this.getGameList();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"initComponent",value:function(){this.dxDataGrid1=this.getDxInstanceByKey(this.dxDataGridKey1);var e=[{dataField:"id",caption:"编号",width:80},{allowFiltering:!0,allowSorting:!0,dataField:"game_title",caption:"所属游戏",width:120},{allowFiltering:!0,allowSorting:!0,dataField:"title",caption:"区服名称",width:120},{dataField:"include_region_codes",caption:"包含区域",width:100,cellTemplate:function(e,t){var a=[];try{var i=t.value.toString().split(","),n=!0,r=!1,d=void 0;try{for(var c,l=o()(i);!(n=(c=l.next()).done);n=!0){var s=c.value;s&&""!=s&&a.push(k["a"].getDicText(k["a"].getDictonary().data.region_code,Number(s)))}}catch(u){r=!0,d=u}finally{try{n||null==l.return||l.return()}finally{if(r)throw d}}}catch(p){}m()("<span>").append(a.join(",")).appendTo(e)}},{dataField:"exclude_region_codes",caption:"排除区域",width:100,cellTemplate:function(e,t){var a=[];try{var i=t.value.toString().split(","),n=!0,r=!1,d=void 0;try{for(var c,l=o()(i);!(n=(c=l.next()).done);n=!0){var s=c.value;s&&""!=s&&a.push(k["a"].getDicText(k["a"].getDictonary().data.region_code,Number(s)))}}catch(u){r=!0,d=u}finally{try{n||null==l.return||l.return()}finally{if(r)throw d}}}catch(p){}m()("<span>").append(a.join(",")).appendTo(e)}},{dataField:"remark",caption:"备注",width:200},{allowFiltering:!0,allowSorting:!0,dataField:"order_id",caption:"排序",width:80},{visible:!1,dataField:"parent_area_title",caption:"上级区服",width:120},{visible:!1,allowFiltering:!0,allowSorting:!0,dataField:"hint",caption:"玩家提醒",width:120},{dataField:"create_time",caption:"创建时间",width:160},{dataField:"create_staff_name",caption:"创建人",width:80},{fixed:!0,fixedPosition:"right",dataField:"id",alignment:"center",caption:b["a"].Operate,width:200,cellTemplate:this.cellEdit}],t=this.getDataGridOption({onToolbarPreparing:this.onToolbarPreparingHandler,columns:e,onRowClick:this.onRowClickHandler});this.dxDataGrid1.option(t)}},{key:"onRowClickHandler",value:function(e){var t=this;this.dbClick(function(){t.redirect("/game/area/edit/"+e.key.id)})}},{key:"cellEdit",value:function(e,t){var a=this,i=m()("<a href='javascript:void(0)'> 区域设置 </a>");i.bind("click",function(e){a.regionAreaDataList(t.value,t.data.game_id)});var n=this.getCreateLink("编辑",function(e){a.redirect("/game/area/edit/"+t.value)}),r=this.getCreateLink("绑定线路关系",function(e){var i=a.$refs["AreaLine"];i.show(t.value,{title:"绑定游戏区服与线路关系",width:500})});m()("<div>").append(n).append(" | ").append(i).append(" | ").append(r).appendTo(e)}},{key:"getGameList",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this.getDataGridPager(function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,i,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.gameAPI.AreaListPager(t,i,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,a,i){return e.apply(this,arguments)}}()),this.dxDataGrid1.option({remoteOperations:!0,dataSource:t});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"onToolbarPreparingHandler",value:function(e){var t=this,a=(e.component,e.toolbarOptions.items);a.push({location:"before",widget:"dxButton",options:{text:b["a"].Add,icon:"add",onClick:this.onAddHandler}}),a.push({location:"before",widget:"dxButton",options:{icon:"refresh",text:"刷新",onClick:this.onRefreshHandler}}),this.createSearchToolbars(a,this.dxDataGrid1.option("columns"),function(){t.getGameList()},"game_title",R["a"].contain)}},{key:"onAddHandler",value:function(e){this.redirect("/game/area/edit")}},{key:"onRefreshHandler",value:function(e){this.dxDataGrid1.refresh()}},{key:"regionAreaDataList",value:function(e,t){var a=this;this.grid_area=this.createPopDataList({title:"游戏区服本地化列表"},{columns:[{dataField:"id",caption:"编号",width:80},{dataField:"game_title",caption:"所属游戏",width:100},{dataField:"area_title",caption:"所属区服",width:100},{dataField:"region_code",caption:"区域代码",width:100,cellTemplate:function(e,t){m()("<span>").append(k["a"].getDicText(k["a"].getDictonary().data.region_code,t.value)).appendTo(e)}},{dataField:"title",caption:"标题",width:160},{dataField:"remark",caption:"备注",width:160},{dataField:"create_staff_name",caption:"创建管理员",width:160},{dataField:"create_time",caption:"创建时间",width:160},{dataField:"change_staff_name",caption:"修改管理员",width:160},{dataField:"change_time",caption:"修改时间",width:160},{fixed:!0,fixedPosition:"right",dataField:"id",alignment:"center",caption:"操作",width:200,cellTemplate:function(e,t){var i=m()("<a href='javascript:void(0)'> 编辑 </a>");i.bind("click",function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(i){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.gameAreaRegionApi.getModel(t.value);case 2:n=e.sent,a.regionAreaDataEdit(n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),m()("<div>").append(i).appendTo(e)}}]},function(i){var n=i.toolbarOptions.items;n.push({location:"before",widget:"dxButton",options:{text:"添加",icon:"add",onClick:function(i){a.regionAreaDataEdit({id:0,game_id:t,area_id:e})}}}),n.push({location:"before",widget:"dxButton",options:{text:"刷新",icon:"refresh",onClick:function(e){a.grid_area.refresh()}}})}),this.setSearchKeywords("&area_id="+e);var i=this.getDataGridPager(function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,i,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.gameAreaRegionApi.getListPager(t,i,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,a,i){return e.apply(this,arguments)}}());this.grid_area.option({remoteOperations:!0,dataSource:i})}},{key:"regionAreaDataEdit",value:function(e){var t=this,a=this.createFormItems([{dataField:"region_code",label:{text:"区域代码"},editorType:"dxSelectBox",editorOptions:{placeholder:"请选择区域代码",dataSource:k["a"].getDictonary().data.region_code,displayExpr:"name",valueExpr:"id"},validationRules:[_["a"].getRequired("区域代码不能为空!")]},{dataField:"title",label:{text:"标题"},editorOptions:{placeholder:"请选输入标题"},validationRules:[_["a"].getRequired("标题不能为空!")]},{dataField:"remark",label:{text:"信息"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入信息.",height:80},validationRules:[_["a"].getRequired("信息不能为空!")]}]);this.createPopForm({title:"编辑游戏区服本地化",width:400,height:300},{formData:e,items:a},{},function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(a,i){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.validateForm(a)){e.next=3;break}return e.abrupt("return",!1);case 3:if(n=a.option("formData"),n.id!=D["a"].zero){e.next=10;break}return e.next=7,t.gameAreaRegionApi.setAdd(n);case 7:r=e.sent,e.next=13;break;case 10:return e.next=12,t.gameAreaRegionApi.setUpdate(n.id,n);case 12:r=e.sent;case 13:if(r.code!=D["a"].OK&&r.code!=D["a"].isSame&&r.code!=D["a"].isSameSaveData){e.next=19;break}return e.next=16,t.toast(function(){t.grid_area.refresh()});case 16:return e.abrupt("return",!0);case 19:t.errorCodeMsg(r.code,r.msg);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](0),t.error(e.t0);case 25:return e.abrupt("return",!1);case 26:case"end":return e.stop()}},e,null,[[0,22]])}));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(w["a"]);A=h["a"]([Object(g["a"])({components:{DxDataGrid:v["DxDataGrid"],AreaLine:F["a"]}})],A);var O=A,T=O,G=T,j=a("17cc"),S=Object(j["a"])(G,i,n,!1,null,null,null);t["default"]=S.exports}}]);