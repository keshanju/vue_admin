(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21ead0"],{d729:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("DxForm",{ref:e.dxFormKey1})],1)},n=[],i=(r("ea65"),r("3a23"),r("77fe")),s=r.n(i),o=(r("4453"),r("ee95")),u=r("eb12"),c=r("ba94"),l=r("5ee8"),d=r("4e86"),h=r("5bc3"),x=r("3a61"),m=r("b2e6"),p=r("74a9"),f=r("a60a"),v=r.n(f),b=r("1639"),k=r("5ab1"),_=r("be44"),D=r("84ec"),w=r("9b13"),F=r("4b0b"),g=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(l["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.dxFormKey1="dxForm_Key_1",e.menuAPI=new k["a"],e.staffAPI=new _["a"],e.dxFormData1={id:0},e.dxFormDataReset1={},e.menu_list=[],e.mene_selected_list=[],e}return Object(h["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,i,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$parent.content_title="员工角色编辑",this.submitText=D["a"].Add,this.ID!==w["a"].zero&&(this.submitText=D["a"].Update),this.initComponent(),e.next=6,this.bindMenuList();case 6:if(this.ID===w["a"].zero){e.next=9;break}return e.next=9,this.getStaffRoleModel(this.ID);case 9:if(this.dxTreeView1.option({dataSource:this.menu_list}),!this.dxFormData1.data_selected_all){e.next=15;break}this.dxCheckBox1.option({value:!0}),this.dxTreeView1.selectAll(),e.next=34;break;case 15:for(t=!0,r=!1,a=void 0,e.prev=18,n=s()(this.mene_selected_list);!(t=(i=n.next()).done);t=!0)o=i.value,this.dxTreeView1.selectItem(o);e.next=26;break;case 22:e.prev=22,e.t0=e["catch"](18),r=!0,a=e.t0;case 26:e.prev=26,e.prev=27,t||null==n.return||n.return();case 29:if(e.prev=29,!r){e.next=32;break}throw a;case 32:return e.finish(29);case 33:return e.finish(26);case 34:this.dxFormDataReset1=v.a.extend(!0,{},this.dxFormData1);case 35:case"end":return e.stop()}},e,this,[[18,22,26,34],[27,,29,33]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"initComponent",value:function(){var e=this;this.dxForm1=this.getDxInstanceByKey(this.dxFormKey1);var t=[{itemType:"group",items:[{dataField:"name",label:{text:D["a"].lang_role_name},editorOptions:{placeholder:"请输入角色名称."},validationRules:[F["a"].getRequired("角色名称不能为空!")]},{label:{text:D["a"].lang_role_data_selected_all},dataField:"data_selected_all",editorType:"dxCheckBox",editorOptions:{onValueChanged:function(t){t.value?e.dxTreeView1.selectAll():e.dxTreeView1.unselectAll()}}},{label:{text:D["a"].lang_role_menu_ids},dataField:"menu_ids",editorType:"dxTreeView",editorOptions:{height:400,displayExpr:"text",valueExpr:"id",showCheckBoxesMode:"normal"}}]},{itemType:"group",colCount:3,items:[{itemType:"button",horizontalAlignment:"center",buttonOptions:{text:this.ID>w["a"].zero?"更新":"添加",type:"success",useSubmitBehavior:!0,onClick:this.onClickDoHandler}},{itemType:"button",horizontalAlignment:"center",buttonOptions:{text:"重置",type:"normal",onClick:this.onResetHandler}},{itemType:"button",horizontalAlignment:"center",buttonOptions:{text:D["a"].Back,type:"normal",onClick:this.onClickBackHandler}}]}],r={formData:this.dxFormData1,items:t,width:500,validationGroup:"customerData"};this.dxForm1.option(r),this.dxTreeView1=this.dxForm1.getEditor("menu_ids"),this.dxCheckBox1=this.dxForm1.getEditor("data_selected_all")}},{key:"onResetHandler",value:function(e){this.dxFormData1=v.a.extend(!0,{},this.dxFormDataReset1),this.dxForm1.option("formData",this.dxFormData1)}},{key:"onClickDoHandler",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,i,o,u,c,l,d,h,x,m,p,f,v,b,k,_=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.validateForm(this.dxForm1)){e.next=3;break}return e.abrupt("return");case 3:if(r=this.dxTreeView1.getNodes(),0!=r.length){e.next=7;break}return this.alert("请至少选择一个菜单!"),e.abrupt("return");case 7:a=[],n=0,i=!0,o=!1,u=void 0,e.prev=12,c=s()(r);case 14:if(i=(l=c.next()).done){e.next=43;break}if(d=l.value,n++,n=d.children.length+n,h=d.children.filter(function(e,t){return e.selected}),!(h.length>0)){e.next=40;break}for(a.push(d.itemData.id),x=!0,m=!1,p=void 0,e.prev=24,f=s()(h);!(x=(v=f.next()).done);x=!0)b=v.value,a.push(b.itemData.id);e.next=32;break;case 28:e.prev=28,e.t0=e["catch"](24),m=!0,p=e.t0;case 32:e.prev=32,e.prev=33,x||null==f.return||f.return();case 35:if(e.prev=35,!m){e.next=38;break}throw p;case 38:return e.finish(35);case 39:return e.finish(32);case 40:i=!0,e.next=14;break;case 43:e.next=49;break;case 45:e.prev=45,e.t1=e["catch"](12),o=!0,u=e.t1;case 49:e.prev=49,e.prev=50,i||null==c.return||c.return();case 52:if(e.prev=52,!o){e.next=55;break}throw u;case 55:return e.finish(52);case 56:return e.finish(49);case 57:if(a.length==n&&(a=["all"]),this.dxFormData1.menu_ids=a.join(","),this.dxFormData1.id!=w["a"].zero){e.next=65;break}return e.next=62,this.staffAPI.staffRoleGroupAdd(this.dxFormData1.name,this.dxFormData1.menu_ids);case 62:k=e.sent,e.next=68;break;case 65:return e.next=67,this.staffAPI.staffRoleGroupUpdate(this.dxFormData1.id,this.dxFormData1.name,this.dxFormData1.menu_ids);case 67:k=e.sent;case 68:k.code==w["a"].OK||k.code==w["a"].isSame||k.code==w["a"].isSameSaveData?this.toast(function(){_.redirect("/staff/role/list")}):this.errorCodeMsg(k.code,k.msg),e.next=74;break;case 71:e.prev=71,e.t2=e["catch"](0),this.error(e.t2);case 74:case"end":return e.stop()}},e,this,[[0,71],[12,45,49,57],[24,28,32,40],[33,,35,39],[50,,52,56]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"onClickBackHandler",value:function(e){this.redirect("/staff/role/list")}},{key:"bindMenuList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,i,o,u,c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.menuAPI.getList();case 3:for(r=e.sent,a=r.data.filter(function(e,t){return 1==e.menu_level}),n=!0,i=!1,o=void 0,e.prev=8,u=function(){var e,a=l.value,n=a.id,i={id:a.id,level:a.menu_level,pid:a.menu_pid,text:a.menu_name,href:a.menu_route,expanded:!0,items:(e=[],e)},o=r.data.filter(function(e,t){return 2==e.menu_level&&e.menu_pid==n}),u=!0,c=!1,d=void 0;try{for(var h,x=s()(o);!(u=(h=x.next()).done);u=!0){var m=h.value;i.items.push({id:m.id,level:m.menu_level,pid:m.menu_pid,text:m.menu_name,href:m.menu_route})}}catch(p){c=!0,d=p}finally{try{u||null==x.return||x.return()}finally{if(c)throw d}}t.push(i)},c=s()(a);!(n=(l=c.next()).done);n=!0)u();e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](8),i=!0,o=e.t0;case 17:e.prev=17,e.prev=18,n||null==c.return||c.return();case 20:if(e.prev=20,!i){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:this.menu_list=t;case 26:case"end":return e.stop()}},e,this,[[8,13,17,25],[18,,20,24]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"getStaffRoleModel",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,i,o,u,c,l,d,h,x,m,p,f,v,b,k,_,D,w,F;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.staffAPI.staffRoleGroupModel(t);case 2:r=e.sent,a=r.data.menu_ids.split(","),n=[],i=!0,o=!1,u=void 0,e.prev=8,c=s()(this.menu_list);case 10:if(i=(l=c.next()).done){e.next=59;break}if(d=l.value,!(null!=d.items&&d.items.length>0)){e.next=56;break}h=!0,x=!1,m=void 0,e.prev=16,p=s()(d.items);case 18:if(h=(f=p.next()).done){e.next=42;break}for(v=f.value,b=!0,k=!1,_=void 0,e.prev=23,D=s()(a);!(b=(w=D.next()).done);b=!0)F=w.value,v.id==F&&n.push(F);e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](23),k=!0,_=e.t0;case 31:e.prev=31,e.prev=32,b||null==D.return||D.return();case 34:if(e.prev=34,!k){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:h=!0,e.next=18;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e["catch"](16),x=!0,m=e.t1;case 48:e.prev=48,e.prev=49,h||null==p.return||p.return();case 51:if(e.prev=51,!x){e.next=54;break}throw m;case 54:return e.finish(51);case 55:return e.finish(48);case 56:i=!0,e.next=10;break;case 59:e.next=65;break;case 61:e.prev=61,e.t2=e["catch"](8),o=!0,u=e.t2;case 65:e.prev=65,e.prev=66,i||null==c.return||c.return();case 68:if(e.prev=68,!o){e.next=71;break}throw u;case 71:return e.finish(68);case 72:return e.finish(65);case 73:this.mene_selected_list=n,this.dxFormData1=r.data,this.dxFormData1.data_selected_all="all"==r.data.menu_ids,this.dxForm1.option({formData:this.dxFormData1});case 77:case"end":return e.stop()}},e,this,[[8,61,65,73],[16,44,48,56],[23,27,31,39],[32,,34,38],[49,,51,55],[66,,68,72]])}));function t(t){return e.apply(this,arguments)}return t}()}]),t}(b["a"]);g=x["a"]([Object(m["a"])({components:{DxDataGrid:p["DxDataGrid"],DxForm:p["DxForm"],DxTreeView:p["DxTreeView"]}})],g);var y=g,R=y,T=R,O=r("17cc"),C=Object(O["a"])(T,a,n,!1,null,null,null);t["default"]=C.exports}}]);