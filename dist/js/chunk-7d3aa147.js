(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d3aa147"],{c2e5:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home"},[r("DxForm",{ref:e.dxFormKey1})],1)},n=[],i=(r("4453"),r("ee95")),s=r("eb12"),o=r("ba94"),u=r("5ee8"),c=r("4e86"),d=r("5bc3"),p=r("3a61"),l=r("b2e6"),h=r("74a9"),x=r("a60a"),m=r.n(x),f=r("1639"),v=r("effb"),b=r("84ec"),y=r("9b13"),g=r("4b0b"),k=r("4c5d"),w=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.dxFormKey1="dxForm_Key_1",e.cardsAPI=new v["a"],e.dxFormData1={id:0,is_valid:1,price_type:1,card_type:0},e.dxFormDataReset1={},e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.submitText=b["a"].Add,this.ID!==y["a"].zero&&(this.submitText=b["a"].Update),this.initComponent(),this.ID===y["a"].zero){e.next=6;break}return e.next=6,this.getCardsModel(this.ID);case 6:this.dxFormDataReset1=m.a.extend(!0,{},this.dxFormData1);case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"initComponent",value:function(){this.dxForm1=this.getDxInstanceByKey(this.dxFormKey1);var e=[];e.push({dataField:"title",label:{text:"卡名称"},editorOptions:{placeholder:"请输入卡名称"},validationRules:[g["a"].getRequired("卡名称不能为空!")]}),e.push({dataField:"card_prefix",label:{text:"卡前缀"},editorOptions:{placeholder:"请输入卡前缀"},validationRules:[g["a"].getRequired("卡前缀不能为空!")]}),e.push({dataField:"is_valid",editorType:"dxSelectBox",label:{text:"是否有效"},editorOptions:{displayExpr:"name",valueExpr:"id",dataSource:k["a"].getDictonary().data.flag}}),e.push({dataField:"price_type",editorType:"dxSelectBox",label:{text:"价格类型"},editorOptions:{displayExpr:"name",valueExpr:"id",dataSource:k["a"].getDictonary().data.price_type}}),e.push({dataField:"price",label:{text:"价格(分)"},editorType:"dxNumberBox",editorOptions:{placeholder:"请输入价格",value:0},validationRules:[g["a"].getRequired("价格不能为空!")]}),e.push({dataField:"minutes",label:{text:"分钟数"},editorType:"dxNumberBox",editorOptions:{value:1,placeholder:"分钟数"},validationRules:[g["a"].getRequired("分钟数不能为空!")]}),e.push({dataField:"card_type",label:{text:"卡定义类型"},editorType:"dxSelectBox",editorOptions:{placeholder:"请选择卡定义类型",displayExpr:"name",valueExpr:"id",dataSource:k["a"].getDictonary().data.card_define_type},validationRules:[g["a"].getRequired("卡定义类型不能为空!")]}),e.push({dataField:"max_used_count",label:{text:"同一用户使用次数"},editorType:"dxNumberBox",editorOptions:{value:0,placeholder:"同一用户使用次数，0：不限制"},validationRules:[g["a"].getRequired("同一用户使用次数不能为空!")]}),e.push({dataField:"desc",label:{text:"说明"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入说明"},validationRules:[g["a"].getRequired("说明不能为空!")]});var t=[];t.push({itemType:"button",horizontalAlignment:"center",buttonOptions:{text:this.ID>0?b["a"].Update:b["a"].Add,type:"success",useSubmitBehavior:!0,onClick:this.onClickDoHandler}}),0==this.ID&&t.push({itemType:"button",horizontalAlignment:"center",buttonOptions:{text:"重置",type:"normal",onClick:this.onResetHandler}}),t.push({itemType:"button",horizontalAlignment:"center",buttonOptions:{text:b["a"].Back,type:"normal",useSubmitBehavior:!0,onClick:this.onClickBackHandler}});var r=[];r.push({itemType:"group",caption:b["a"].Edit,items:e},{itemType:"group",colCount:3,items:t});var a={formData:this.dxFormData1,items:r,width:500};this.dxForm1.option(a)}},{key:"onResetHandler",value:function(e){this.dxFormData1=m.a.extend(!0,{},this.dxFormDataReset1),this.dxForm1.option("formData",this.dxFormData1)}},{key:"onClickDoHandler",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,this.validateForm(this.dxForm1)){e.next=3;break}return e.abrupt("return");case 3:if(this.dxFormData1.account_token=this.token,t=this.joinFormParams(this.dxFormData1),this.dxFormData1.id!=y["a"].zero){e.next=11;break}return e.next=8,this.cardsAPI.cardsAdd(t);case 8:r=e.sent,e.next=14;break;case 11:return e.next=13,this.cardsAPI.cardsUpdate(this.dxFormData1.id,t);case 13:r=e.sent;case 14:r.code==y["a"].OK||r.code==y["a"].isSame||r.code==y["a"].isSameSaveData?this.toast(function(){a.redirect("/card/list")}):this.errorCodeMsg(r.code,r.msg),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](0),this.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[0,17]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onClickBackHandler",value:function(){this.redirect("/card/list")}},{key:"getCardsModel",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.cardsAPI.getCardsModel(t);case 2:r=e.sent,this.dxFormData1=r.data,this.dxForm1.option("formData",this.dxFormData1);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}]),t}(f["a"]);w=p["a"]([Object(l["a"])({components:{DxDataGrid:h["DxDataGrid"],DxForm:h["DxForm"],DxTreeView:h["DxTreeView"]}})],w);var D=w,R=D,F=R,O=r("17cc"),j=Object(O["a"])(F,a,n,!1,null,null,null);t["default"]=j.exports},effb:function(e,t,r){"use strict";r.d(t,"a",function(){return d});r("4453");var a=r("ee95"),n=r("eb12"),i=r("ba94"),s=r("5ee8"),o=r("4e86"),u=r("5bc3"),c=r("f322"),d=function(e){function t(){return Object(n["a"])(this,t),Object(s["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"cardsListPager",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,i,s=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"",r=s.length>1&&void 0!==s[1]?s[1]:15,a=s.length>2&&void 0!==s[2]?s[2]:1,n="/staff/card?account_token="+this.token+"&size="+r+"&page="+a+t,e.next=6,this.httpGet(n);case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"cardsAdd",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r="/staff/card",e.next=3,this.httpPost(r,t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"cardsUpdate",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,r){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a="/staff/card/"+t,e.next=3,this.httpPut(a,r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getCardsModel",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r="/staff/card/"+t+"?account_token="+this.token,e.next=3,this.httpGet(r);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"cardsGenerate",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,r){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a="/staff/card/"+t+"/generate",e.next=3,this.httpPost(a,r);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getSimpleListResult",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t="/staff/card/list?account_token="+this.token,e.next=3,this.httpGet(t);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getCardsExportData",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,r){var a,n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a="/staff/cards/export",n={account_token:this.token,id:t,super_password:r},e.next=4,this.httpPostJsonDownFile(a,n,"export_cards.xlsx");case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()}]),t}(c["a"])}}]);