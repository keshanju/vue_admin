(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a803ba92"],{4910:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a("4453");var i=a("ee95"),r=a("eb12"),n=a("ba94"),o=a("5ee8"),d=a("4e86"),s=a("5bc3"),c=a("f322"),l=function(e){function t(){return Object(r["a"])(this,t),Object(o["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(s["a"])(t,e),Object(n["a"])(t,[{key:"gameListPager",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a,i,r,n,o=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"",a=o.length>1&&void 0!==o[1]?o[1]:15,i=o.length>2&&void 0!==o[2]?o[2]:1,r="/staff/game?account_token="+this.token+"&size="+a+"&page="+i+t,e.next=6,this.httpGet(r);case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"gameAdd",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a="/staff/game",e.next=3,this.httpPost(a,t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"gameUpdate",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,a){var i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i="/staff/game/"+t,e.next=3,this.httpPut(i,a);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"getGameModel",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a="/staff/game/"+t+"?account_token="+this.token,e.next=3,this.httpGet(a);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getListResult",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t="/staff/game/lists?account_token="+this.token,e.next=3,this.httpGet(t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),t}(c["a"])},c08a:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("dx-popup",{ref:"dxPopup1",attrs:{visible:e.options.visible,title:e.options.title},on:{"update:visible":function(t){return e.$set(e.options,"visible",t)}}},[a("dx-scroll-view",[a("dx-data-grid",{ref:"dxDataGrid1"})],1)],1),a("AreaEdit",{ref:"AreaEdit1"}),a("AreaLine",{ref:"AreaLine"})],1)},r=[],n=a("208e"),o=a.n(n),d=(a("4453"),a("ee95")),s=a("eb12"),c=a("ba94"),l=a("5ee8"),u=a("4e86"),p=a("5bc3"),h=a("3a61"),g=a("b2e6"),x=a("a60a"),m=a.n(x),f=a("74a9"),_=a("1639"),v=a("59f2"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("dx-popup",{attrs:{visible:e.options.visible,title:e.options.title,toolbarItems:e.options.toolbarItems},on:{"update:visible":function(t){return e.$set(e.options,"visible",t)}}},[a("dx-scroll-view",[a("dx-form",{ref:"dxForm1"})],1)],1)},w=[],F=(a("48fb"),a("4b0b")),y=a("4c5d"),k=a("4910"),D=a("9b13"),O=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.options={title:"弹窗",visible:!1,toolbarItems:[]},e.dxFormData1={id:0,order_id:999,include_region_codes:"",include_region_codes_arr:[],exclude_region_codes:"",exclude_region_codes_arr:[]},e.dxFormDataNew1={id:0,order_id:999,include_region_codes:"",include_region_codes_arr:[],exclude_region_codes:"",exclude_region_codes_arr:[]},e.areaAPI=new v["a"],e.gameAPI=new k["a"],e}return Object(p["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){this.initToolbarItems()}},{key:"initToolbarItems",value:function(){var e=this;this.options.toolbarItems.push({location:"after",toolbar:"bottom",widget:"dxButton",options:{text:"保存",type:"success",onClick:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.validateForm(e.dxForm1)){t.next=3;break}return t.abrupt("return");case 3:if(e.dxFormData1.account_token=e.token,e.dxFormData1.include_region_codes=e.dxFormData1.include_region_codes_arr.join(","),e.dxFormData1.exclude_region_codes=e.dxFormData1.exclude_region_codes_arr.join(","),a=e.joinFormParams(e.dxFormData1),e.dxFormData1.include_region_codes&&""!=e.dxFormData1.include_region_codes?a+="&exclude_region_codes=":e.dxFormData1.exclude_region_codes&&""!=e.dxFormData1.exclude_region_codes?a+="&include_region_codes=":a+="&include_region_codes=&exclude_region_codes=",e.dxFormData1.id!=D["a"].zero){t.next=14;break}return t.next=11,e.areaAPI.areaAdd(a);case 11:i=t.sent,t.next=17;break;case 14:return t.next=16,e.areaAPI.areaUpdate(e.dxFormData1.id,a);case 16:i=t.sent;case 17:i.code==D["a"].OK||i.code==D["a"].isSame||i.code==D["a"].isSameSaveData?e.toast(function(){e.hide(!0)}):e.errorCodeMsg(i.code,i.msg),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),e.error(t.t0);case 23:case"end":return t.stop()}},t,null,[[0,20]])}));function a(){return t.apply(this,arguments)}return a}()}}),this.options.toolbarItems.push({location:"after",toolbar:"bottom",widget:"dxButton",options:{text:"重置",type:"normal",onClick:function(){}}}),this.options.toolbarItems.push({location:"after",toolbar:"bottom",widget:"dxButton",options:{text:"取消",type:"normal",onClick:function(t){e.hide()}}})}},{key:"initWidgets",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var t,a,i,r,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(new k["a"]).getListResult();case 2:t=e.sent,this.dxForm1=this.getDxInstanceByKey("dxForm1"),a=[{dataField:"title",label:{text:"区服名"},editorOptions:{placeholder:"请输入区服名"},validationRules:[F["a"].getRequired("区服名不能为空!")]},this.createUploadFileFormItem(function(e){},{dataField:"pic",label:{text:"上传图片"}},{name:"filename",uploadUrl:this.uploadApi.getUploadNormalPath("area")},!0),{dataField:"remark",label:{text:"区服备注"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入区服备注"},validationRules:[F["a"].getRequired("区服备注不能为空!")]},{dataField:"order_id",label:{text:"排序"},editorType:"dxNumberBox",editorOptions:{placeholder:"排序编号",min:0}},{dataField:"game_ss_rules",label:{text:"游戏ss规则"},editorType:"dxTextArea",editorOptions:{placeholder:"游戏ss规则",height:120}},{dataField:"game_ios_rules",label:{text:"游戏ios规则"},editorType:"dxTextArea",editorOptions:{placeholder:"游戏ios规则",height:120}},{dataField:"game_android_rules",label:{text:"游戏android规则"},editorType:"dxTextArea",editorOptions:{placeholder:"游戏android规则",height:120}},{dataField:"game_host_rules",label:{text:"主机游戏规则"},editorType:"dxTextArea",editorOptions:{placeholder:"主机游戏规则",height:120}},{dataField:"game_mac_rules",label:{text:"mac游戏规则"},editorType:"dxTextArea",editorOptions:{placeholder:"mac游戏规则",height:120}},{dataField:"game_vpn_rules",label:{text:"vpn规则"},editorType:"dxTextArea",editorOptions:{placeholder:"vpn规则",height:120}},{dataField:"parent_area_id",label:{text:"上级区服"},editorType:"dxSelectBox",editorOptions:{placeholder:"请选择上级区服",displayExpr:"title",valueExpr:"id",searchEnabled:!0}},{dataField:"background_game_id",label:{text:"选择所属背景游戏"},editorType:"dxSelectBox",editorOptions:{placeholder:"请选择所属背景游戏",dataSource:t.data,displayExpr:"title",valueExpr:"id",searchEnabled:!0}},{dataField:"hint",label:{text:"玩家提醒"},editorOptions:{placeholder:"玩家提醒"}},{dataField:"include_region_codes_arr",label:{text:"包含地区"},editorType:"dxTagBox",editorOptions:{placeholder:"请选择包含地区.",displayExpr:"name",valueExpr:"id",showSelectionControls:!0,applyValueMode:"useButtons",dataSource:y["a"].getDictonary().data.region_code,onValueChanged:function(e){var t=e.value;t&&t.length>0?n.dxForm1.getEditor("exclude_region_codes_arr").option({disabled:!0}):n.dxForm1.getEditor("exclude_region_codes_arr").option({disabled:!1})}}},{dataField:"exclude_region_codes_arr",label:{text:"排除地区"},editorType:"dxTagBox",editorOptions:{placeholder:"请选择排除地区.",displayExpr:"name",valueExpr:"id",showSelectionControls:!0,applyValueMode:"useButtons",dataSource:y["a"].getDictonary().data.region_code,onValueChanged:function(e){var t=e.value;t&&t.length>0?n.dxForm1.getEditor("include_region_codes_arr").option({disabled:!0}):n.dxForm1.getEditor("include_region_codes_arr").option({disabled:!1})}}},{dataField:"vpn_prefix_route",label:{text:"前置路由"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入前置路由.",height:100}},{dataField:"vpn_process_rule",label:{text:"进程规则"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入进程规则.",height:100}}],i=[],i.push({itemType:"group",items:a}),r={items:i},this.dxForm1.option(r),this.dxSelectBoxArea=this.dxForm1.getEditor("parent_area_id");case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getGameModel",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.areaAPI.getAreaModel(t);case 2:a=e.sent,this.dxFormData1=a.data,this.dxFormData1.include_region_codes_arr=this.getRegionCode(this.dxFormData1.include_region_codes),this.dxFormData1.exclude_region_codes_arr=this.getRegionCode(this.dxFormData1.exclude_region_codes);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"show",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var t,a,i,r=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{game_id:0,area_id:0},a=r.length>1?r[1]:void 0,o()(this.options,a),this.options.visible=!0,!(t.area_id>0)){e.next=9;break}return e.next=7,this.getGameModel(t.area_id);case 7:e.next=10;break;case 9:this.dxFormData1=m.a.extend(!0,{},this.dxFormDataNew1);case 10:if(this.initWidgets(),this.dxForm1.option("formData",this.dxFormData1),!(t.game_id>0)){e.next=18;break}return this.dxFormData1.game_id=t.game_id,e.next=16,this.areaAPI.getListResult("",t.game_id.toString());case 16:i=e.sent,this.dxSelectBoxArea.option({dataSource:i.data});case 18:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.options.visible=!1,this.options.onHide&&this.options.onHide(e)}}]),t}(_["a"]);O=h["a"]([Object(g["a"])({components:{DxDataGrid:f["DxDataGrid"],DxForm:f["DxForm"],DxTreeView:f["DxTreeView"],DxPopup:f["DxPopup"],DxScrollView:f["DxScrollView"]}})],O);var A=O,R=A,T=a("17cc"),j=Object(T["a"])(R,b,w,!1,null,null,null),S=j.exports,P=a("87b4"),E=a("978f"),G=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.options={gameid:0,title:"弹窗",visible:!1,toolbarItems:[]},e.gameAPI=new v["a"],e.game_id=0,e.gameAreaRegionApi=new E["a"],e}return Object(p["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){this.initWidgets()}},{key:"initWidgets",value:function(){var e=this,t=this.getDxInstanceByKey("dxPopup1");t.option({toolbarItems:[{location:"after",toolbar:"bottom",widget:"dxButton",options:{text:"取消",type:"normal",onClick:function(t){e.hide()}}}]}),this.dxDataGrid1=this.getDxInstanceByKey("dxDataGrid1");var a=[{dataField:"id",caption:"编号",width:80},{allowFiltering:!0,allowSorting:!0,dataField:"game_title",caption:"所属游戏",width:120},{allowFiltering:!0,allowSorting:!0,dataField:"title",caption:"区服名称",width:120},{dataField:"remark",caption:"备注",width:200},{allowFiltering:!0,allowSorting:!0,dataField:"order_id",caption:"排序",width:80},{visible:!1,dataField:"parent_area_title",caption:"上级区服",width:120},{visible:!1,allowFiltering:!0,allowSorting:!0,dataField:"hint",caption:"玩家提醒",width:120},{dataField:"create_time",caption:"创建时间",width:160},{dataField:"create_staff_name",caption:"创建人",width:80},{fixed:!0,fixedPosition:"right",dataField:"id",alignment:"center",caption:"操作",width:200,cellTemplate:this.cellEdit}],i=this.getDataGridOption({onToolbarPreparing:this.onToolbarPreparingHandler,columns:a});this.dxDataGrid1.option(i)}},{key:"cellEdit",value:function(e,t){var a=this,i=m()("<a href='javascript:void(0)'> 区域设置 </a>");i.bind("click",function(e){a.regionAreaDataList(t.value,t.data.game_id)});var r=this.getCreateLink("编辑",function(e){a.$refs["AreaEdit1"].show({area_id:t.value,game_id:a.game_id},{title:"编辑游戏区服",onHide:function(e){e&&a.dxDataGrid1.refresh()}})}),n=this.getCreateLink("绑定线路关系",function(e){var i=a.$refs["AreaLine"];i.show(t.value,{title:"绑定游戏区服与线路关系",width:500})});m()("<div>").append(r).append(" | ").append(i).append(" | ").append(n).appendTo(e)}},{key:"onToolbarPreparingHandler",value:function(e){var t=this,a=(e.component,e.toolbarOptions.items);a.push({location:"before",widget:"dxButton",options:{text:"添加",icon:"add",onClick:function(){t.$refs["AreaEdit1"].show({game_id:t.game_id},{title:"增加游戏区服",onHide:function(e){e&&t.dxDataGrid1.refresh()}})}}}),a.push({location:"before",widget:"dxButton",options:{icon:"refresh",text:"刷新",onClick:function(){t.dxDataGrid1.refresh()}}}),this.createSearchToolbars(a,this.dxDataGrid1.option("columns"),function(){t.getGameList()})}},{key:"getGameList",value:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this.getDataGridPager(function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,i,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=t+"&game_id="+a.game_id,e.next=3,a.gameAPI.AreaListPager(t,i,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t,a,i){return e.apply(this,arguments)}}()),this.dxDataGrid1.option({remoteOperations:!0,dataSource:t});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;o()(this.options,t),this.options.visible=!0,this.game_id=e,e>0&&this.getGameList()}},{key:"hide",value:function(){this.options.visible=!1,this.options.onHide&&this.options.onHide()}},{key:"regionAreaDataList",value:function(e,t){var a=this;this.grid_area=this.createPopDataList({title:"游戏区服本地化列表"},{columns:[{dataField:"id",caption:"编号",width:80},{dataField:"game_title",caption:"所属游戏",width:100},{dataField:"area_title",caption:"所属区服",width:100},{dataField:"region_code",caption:"区域代码",width:100,cellTemplate:function(e,t){m()("<span>").append(y["a"].getDicText(y["a"].getDictonary().data.region_code,t.value)).appendTo(e)}},{dataField:"title",caption:"标题",width:160},{dataField:"remark",caption:"备注",width:160},{dataField:"create_staff_name",caption:"创建管理员",width:160},{dataField:"create_time",caption:"创建时间",width:160},{dataField:"change_staff_name",caption:"修改管理员",width:160},{dataField:"change_time",caption:"修改时间",width:160},{fixed:!0,fixedPosition:"right",dataField:"id",alignment:"center",caption:"操作",width:200,cellTemplate:function(e,t){var i=m()("<a href='javascript:void(0)'> 编辑 </a>");i.bind("click",function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(i){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.gameAreaRegionApi.getModel(t.value);case 2:r=e.sent,a.regionAreaDataEdit(r.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),m()("<div>").append(i).appendTo(e)}}]},function(i){var r=i.toolbarOptions.items;r.push({location:"before",widget:"dxButton",options:{text:"添加",icon:"add",onClick:function(i){a.regionAreaDataEdit({id:0,game_id:t,area_id:e})}}}),r.push({location:"before",widget:"dxButton",options:{text:"刷新",icon:"refresh",onClick:function(e){a.grid_area.refresh()}}})}),this.setSearchKeywords("&area_id="+e);var i=this.getDataGridPager(function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,i,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.gameAreaRegionApi.getListPager(t,i,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,a,i){return e.apply(this,arguments)}}());this.grid_area.option({remoteOperations:!0,dataSource:i})}},{key:"regionAreaDataEdit",value:function(e){var t=this,a=this.createFormItems([{dataField:"region_code",label:{text:"区域代码"},editorType:"dxSelectBox",editorOptions:{placeholder:"请选择区域代码",dataSource:y["a"].getDictonary().data.region_code,displayExpr:"name",valueExpr:"id"},validationRules:[F["a"].getRequired("区域代码不能为空!")]},{dataField:"title",label:{text:"标题"},editorOptions:{placeholder:"请选输入标题"},validationRules:[F["a"].getRequired("标题不能为空!")]},{dataField:"remark",label:{text:"信息"},editorType:"dxTextArea",editorOptions:{placeholder:"请输入信息.",height:80},validationRules:[F["a"].getRequired("信息不能为空!")]}]);this.createPopForm({title:"编辑游戏区服本地化",width:400,height:300},{formData:e,items:a},{},function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(a,i){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.validateForm(a)){e.next=3;break}return e.abrupt("return",!1);case 3:if(r=a.option("formData"),r.id!=D["a"].zero){e.next=10;break}return e.next=7,t.gameAreaRegionApi.setAdd(r);case 7:n=e.sent,e.next=13;break;case 10:return e.next=12,t.gameAreaRegionApi.setUpdate(r.id,r);case 12:n=e.sent;case 13:if(n.code!=D["a"].OK&&n.code!=D["a"].isSame&&n.code!=D["a"].isSameSaveData){e.next=19;break}return e.next=16,t.toast(function(){t.grid_area.refresh()});case 16:return e.abrupt("return",!0);case 19:t.errorCodeMsg(n.code,n.msg);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](0),t.error(e.t0);case 25:return e.abrupt("return",!1);case 26:case"end":return e.stop()}},e,null,[[0,22]])}));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(_["a"]);G=h["a"]([Object(g["a"])({components:{DxDataGrid:f["DxDataGrid"],DxPopup:f["DxPopup"],AreaEdit:S,DxScrollView:f["DxScrollView"],AreaLine:P["a"]}})],G);var I=G,B=I,C=Object(T["a"])(B,i,r,!1,null,null,null);t["a"]=C.exports}}]);